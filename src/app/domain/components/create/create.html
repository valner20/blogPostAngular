<div class="modalFondo" (click)="onClose()"></div>
<div class="modal" (click)="$event.stopPropagation()">

  <div class="modal-header">
    <h2>Create New Post</h2>
    <button class="close-button" (click)="onClose()">âœ•</button>
  </div>

  <div class="modal-content">
    <form [formGroup]="form" (ngSubmit)="submit()">

      <div class="form-group">
        <label for="title">Title</label>
        <div class="input-wrapper">
          <input
            id="title"
            type="text"
            formControlName="title"
            placeholder="Enter post title..."
          />
          @if (form.get('title')?.touched && form.get('title')?.invalid) {
            <small class="error">Title is required</small>
          }
        </div>
      </div>

     <div class="form-group">
        <label for="content">Content</label>
        <div class="input-wrapper" id="editor-container">
          <quill-editor
            formControlName="content"
            [modules]="quillConfig"
            [styles]="{
              minHeight: '200px',
              maxHeight: '400px'
            }"
            class="rich-editor"
            placeholder="Write your post content here...">
          </quill-editor>
          @if (form.get('content')?.touched && form.get('content')?.invalid) {
            <small class="error">Content is required</small>
          }
        </div>
      </div>

      <div class="permissions-grid">
        <div class="permission-card">
          <div class="form-group">
            <label for="is_public">Public</label>
            <div class="input-wrapper">
              <select id="is_public" formControlName="is_public">
                @for (opt of is_public(); track opt.value) {
                  <option [value]="opt.value">{{ opt.label }}</option>
                }
              </select>
              @if (form.get('is_public')?.touched && form.get('is_public')?.invalid) {
                <small class="error">Required field</small>
              }
            </div>
          </div>
        </div>

        <div class="permission-card">
          <div class="form-group">
            <label for="authenticated">Authenticated</label>
            <div class="input-wrapper">
              <select id="authenticated" formControlName="authenticated">
                @for (opt of auth(); track opt.value) {
                  <option [value]="opt.value">{{ opt.label }}</option>
                }
              </select>
              @if (form.get('authenticated')?.touched && form.get('authenticated')?.invalid) {
                <small class="error">Required field</small>
              }
            </div>
          </div>
        </div>

        <div class="permission-card">
          <div class="form-group">
            <label for="team">Team</label>
            <div class="input-wrapper">
              <select id="team" formControlName="team">
                @for (opt of teamOptions(); track opt.value) {
                  <option [value]="opt.value">{{ opt.label }}</option>
                }
              </select>
              @if (form.get('team')?.touched && form.get('team')?.invalid) {
                <small class="error">Required field</small>
              }
            </div>
          </div>
        </div>
      </div>

      <div class="buttons">
        <button type="button" class="btn-secondary" (click)="onClose()">
          Cancel
        </button>
        <button type="submit" class="btn-primary" [disabled]="form.invalid">
          Publish Post
        </button>
      </div>

    </form>
  </div>
</div>
